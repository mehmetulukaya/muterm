version: 1.0.{build}

image: Visual Studio 2022

install:
  - choco install lazarus --version=4.0.0 --yes

before_build:
  - set PATH=C:\lazarus\fpc\3.2.2\bin\x86_64-win64;C:\lazarus;%PATH%
  - lazbuild --version

  # Online Package Manager ile LNet kurulumu
  - curl -L https://github.com/LongDirtyAnimAlf/Reiniero-OPM/releases/download/opm_v1.6/opm_1.6_stable.zip -o C:\opm.zip
  - 7z x C:\opm.zip -oC:\lazarus\components\opm -y
  - C:\lazarus\lazarus.exe --build-ide=""

  # LazSerial - GitHub'dan
  - git clone https://github.com/JurassicPork/TLazSerial.git C:\Components\lazserial
  - lazbuild --add-package C:\Components\lazserial\lazserialport.lpk

  # PascalScript
  - git clone https://github.com/remobjects/pascalscript.git C:\Components\pascalscript
  - lazbuild --add-package C:\Components\pascalscript\Source\PascalScript.lpk

build_script:
  - ps: |
      cd $env:APPVEYOR_BUILD_FOLDER
      lazbuild --os=win64 --cpu=x86_64 muterm.lpi

artifacts:
  - path: muterm.exe
    name: muterm

test: off
